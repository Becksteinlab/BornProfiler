# APBS input file generated by placeion.py
# for the complex and the ion
# %(comment)s
# Uses a membrane and manual focusing in three steps.

READ
   # molecules
   mol pqr %(protein_pqr)s
   mol pqr %(ion_pqr)s
   mol pqr %(complex_pqr)s

   # maps for protein only
   diel dx dielxLm.dx dielyLm.dx dielzLm.dx
   diel dx dielxMm.dx dielyMm.dx dielzMm.dx
   diel dx dielxSm.dx dielySm.dx dielzSm.dx

   kappa dx kappaLm.dx
   kappa dx kappaMm.dx
   kappa dx kappaSm.dx

   charge dx chargeLm.dx
   charge dx chargeMm.dx
   charge dx chargeSm.dx

   # maps for complex
   # (note that the stupid naming scheme works
   # around a bug in the naming code in draw_membrane2.c --
   # better keep the length of the filename the same :-p)
   diel dx dieCxLm.dx dieCyLm.dx dieCzLm.dx
   diel dx dieCxMm.dx dieCyMm.dx dieCzMm.dx
   diel dx dieCxSm.dx dieCySm.dx dieCzSm.dx

   kappa dx kappCLm.dx
   kappa dx kappCMm.dx
   kappa dx kappCSm.dx

   charge dx chargCLm.dx
   charge dx chargCMm.dx
   charge dx chargCSm.dx

END

# Focus each calculation in three steps

#------------------------------------------------------------
# Protein alone (mol 1)
#------------------------------------------------------------
#
# focusing step (1): whole system
ELEC name protein_L
  mg-manual
  mol 1
  dime %(DIME_XYZ_L)s
  nlev 4
  glen %(GLEN_XYZ_L)s
  gcent mol 1
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl zero
  pdie %(pdie)f
  sdie %(sdie)f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy total
  calcforce no
  usemap diel 1
  usemap kappa 1
  usemap charge 1
END

# focus but now center on ion position (mol 2)
# and use potential from boundary of previous calc (bcfl focus)
ELEC name protein_M
  mg-manual
  mol 1
  dime %(DIME_XYZ_M)s
  nlev 4
  glen %(GLEN_XYZ_M)s
  gcent mol 2
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl focus
  pdie %(pdie)f
  sdie %(sdie)f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy total
  calcforce no
  usemap diel 2
  usemap kappa 2
  usemap charge 2
END

ELEC name protein_S
  mg-manual
  mol 1
  dime %(DIME_XYZ_S)s
  nlev 4
  glen %(GLEN_XYZ_S)s
  gcent mol 2
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl focus
  pdie %(pdie)f
  sdie %(sdie)f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy total
#  calcenergy comps
  calcforce no
  usemap diel 3
  usemap kappa 3
  usemap charge 3
END

#------------------------------------------------------------
# Ion in solvent (mol 2)
#------------------------------------------------------------
#
# focusing step (1): whole system
# (note: no membrane because the reference state for our Born
# ion is the aqueous phase).
ELEC name ion_L
  mg-manual
  mol 2
  dime %(DIME_XYZ_L)s
  nlev 4
  glen %(GLEN_XYZ_L)s
  gcent mol 1
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl zero
  pdie %(pdie)f
  sdie %(sdie)f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy total
  calcforce no
END

# focus but now center on ion position (mol 2)
# and use potential from boundary of previous calc (bcfl focus)
ELEC name ion_M
  mg-manual
  mol 2
  dime %(DIME_XYZ_M)s
  nlev 4
  glen %(GLEN_XYZ_M)s
  gcent mol 2
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl focus
  pdie %(pdie)f
  sdie %(sdie)f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy total
  calcforce no
END

ELEC name ion_S
  mg-manual
  mol 1
  dime %(DIME_XYZ_S)s
  nlev 4
  glen %(GLEN_XYZ_S)s
  gcent mol 2
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl focus
  pdie %(pdie)f
  sdie %(sdie)f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy total
#  calcenergy comps
  calcforce no
END


#------------------------------------------------------------
# Complex protein+ion (mol 3)
#------------------------------------------------------------
#
# Uses own set of maps
# focusing step (1): whole system
ELEC name complex_L
  mg-manual
  mol 3
  dime %(DIME_XYZ_L)s
  nlev 4
  glen %(GLEN_XYZ_L)s
  gcent mol 1
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl zero
  pdie %(pdie)f
  sdie %(sdie)f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy total
  calcforce no
  usemap diel 4
  usemap kappa 4
  usemap charge 4
END

# focus but now center on ion position (mol 2)
# and use potential from boundary of previous calc (bcfl focus)
ELEC name complex_M
  mg-manual
  mol 3
  dime %(DIME_XYZ_M)s
  nlev 4
  glen %(GLEN_XYZ_M)s
  gcent mol 2
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl focus
  pdie %(pdie)f
  sdie %(sdie)f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy total
  calcforce no
  usemap diel 5
  usemap kappa 5
  usemap charge 5
END

ELEC name complex_S
  mg-manual
  mol 3
  dime %(DIME_XYZ_S)s
  nlev 4
  glen %(GLEN_XYZ_S)s
  gcent mol 2
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl focus
  pdie %(pdie)f
  sdie %(sdie)f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy total
#  calcenergy comps
  calcforce no
  usemap diel 6
  usemap kappa 6
  usemap charge 6
END


# Born free energy from the focused potentials
PRINT elecEnergy complex_S - ion_S - protein_S END
QUIT

