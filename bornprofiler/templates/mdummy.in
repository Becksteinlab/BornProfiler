# Coefficient maps for Born profile calculations
# Build maps for three focusing steps of a Born profile calculation
# Map names are hard coded. Furthermore, in order to work around
# a bug in draw_membrane2.c's naming code, the names have to always
# be the same length --- should be fixed...

READ
   mol pqr %(protein_pqr)s
   mol pqr %(ion_pqr)s
   mol pqr %(complex_pqr)s
END

#------------------------------------------------------------
# Protein alone (mol 1)
#------------------------------------------------------------
#
# focusing step (1): whole system
ELEC name protein_L
  mg-dummy
  mol 1
  dime %(DIME_XYZ_L)s
  nlev 4
  glen %(GLEN_XYZ_L)s
  gcent mol 1
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl zero
  pdie %(pdie).2f
  sdie %(sdie).2f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy no
  calcforce no
  write dielx dx dielx_prot_L
  write diely dx diely_prot_L
  write dielz dx dielz_prot_L
  write kappa dx kappa_prot_L
  write charge dx charge_prot_L
END

# focus but now center on ion position (mol 2)
# and use potential from boundary of previous calc (bcfl focus)
ELEC name protein_M
  mg-dummy
  mol 1
  dime %(DIME_XYZ_M)s
  nlev 4
  glen %(GLEN_XYZ_M)s
  gcent mol 2
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl focus
  pdie %(pdie).2f
  sdie %(sdie).2f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy no
  calcforce no
  write dielx dx dielx_prot_M
  write diely dx diely_prot_M
  write dielz dx dielz_prot_M
  write kappa dx kappa_prot_M
  write charge dx charge_prot_M
END

ELEC name protein_S
  mg-dummy
  mol 1
  dime %(DIME_XYZ_S)s
  nlev 4
  glen %(GLEN_XYZ_S)s
  gcent mol 2
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl focus
  pdie %(pdie).2f
  sdie %(sdie).2f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy no
  calcforce no
  write dielx dx dielx_prot_S
  write diely dx diely_prot_S
  write dielz dx dielz_prot_S
  write kappa dx kappa_prot_S
  write charge dx charge_prot_S
END

#------------------------------------------------------------
# Complex protein+ion (mol 3)
#------------------------------------------------------------
#
# Uses own set of maps
# focusing step (1): whole system
ELEC name complex_L
  mg-dummy
  mol 3
  dime %(DIME_XYZ_L)s
  nlev 4
  glen %(GLEN_XYZ_L)s
  gcent mol 1
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl zero
  pdie %(pdie).2f
  sdie %(sdie).2f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy no
  calcforce no
  write dielx dx dielx_cpx_L
  write diely dx diely_cpx_L
  write dielz dx dielz_cpx_L
  write kappa dx kappa_cpx_L
  write charge dx charge_cpx_L
END

# focus but now center on ion position (mol 2)
ELEC name complex_M
  mg-dummy
  mol 3
  dime %(DIME_XYZ_M)s
  nlev 4
  glen %(GLEN_XYZ_M)s
  gcent mol 2
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl focus
  pdie %(pdie).2f
  sdie %(sdie).2f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy no
  calcforce no
  write dielx dx dielx_cpx_M
  write diely dx diely_cpx_M
  write dielz dx dielz_cpx_M
  write kappa dx kappa_cpx_M
  write charge dx charge_cpx_M
END

ELEC name complex_S
  mg-dummy
  mol 3
  dime %(DIME_XYZ_S)s
  nlev 4
  glen %(GLEN_XYZ_S)s
  gcent mol 2
  # NaCl ionic strength in mol/L
  ion  charge  1   conc %(conc).2f  radius 0.95   # sodium ions
  ion  charge -1   conc %(conc).2f  radius 1.81   # chloride ions
  lpbe
  bcfl focus
  pdie %(pdie).2f
  sdie %(sdie).2f
  srfm mol
  chgm spl2
  srad 1.4
  swin 0.3
  sdens 10.0
  temp %(temperature).2f
  calcenergy no
  calcforce no
  write dielx dx dielx_cpx_S
  write diely dx diely_cpx_S
  write dielz dx dielz_cpx_S
  write kappa dx kappa_cpx_S
  write charge dx charge_cpx_S
END

